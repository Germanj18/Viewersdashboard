"use strict";(()=>{var e={};e.id=757,e.ids=[757],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},61282:e=>{e.exports=require("child_process")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},21764:e=>{e.exports=require("util")},81773:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>b,patchFetch:()=>v,requestAsyncStorage:()=>h,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var r={};o.r(r),o.d(r,{GET:()=>l,POST:()=>c});var s=o(49303),n=o(88716),a=o(60670),i=o(87070);let p=new(o(31059)).Z(process.env.STRIPE_SECRET_KEY,{apiVersion:"2025-06-30.basil"}),u=process.env.STRIPE_WEBHOOK_SECRET;async function c(e){try{let t;let o=await e.text(),r=e.headers.get("stripe-signature");if(!r)return console.error("No stripe signature found"),i.NextResponse.json({error:"No signature"},{status:400});try{t=p.webhooks.constructEvent(o,r,u)}catch(e){return console.error("Webhook signature verification failed:",e),i.NextResponse.json({error:"Invalid signature"},{status:400})}switch(console.log("=== STRIPE WEBHOOK ==="),console.log("Event type:",t.type),console.log("Event ID:",t.id),t.type){case"payment_intent.succeeded":let s=t.data.object;console.log("✅ Payment succeeded:",s.id),console.log("Amount:",s.amount/100,"USD"),console.log("Description:",s.description),console.log("Customer:",s.metadata);break;case"payment_intent.payment_failed":let n=t.data.object;console.log("❌ Payment failed:",n.id),console.log("Failure reason:",n.last_payment_error?.message);break;case"payment_method.attached":console.log("\uD83D\uDCB3 Payment method attached");break;default:console.log(`Unhandled event type: ${t.type}`)}return i.NextResponse.json({received:!0})}catch(e){return console.error("Stripe webhook error:",e),i.NextResponse.json({error:"Webhook handler failed",message:e.message},{status:500})}}async function l(){return i.NextResponse.json({message:"Stripe Webhook endpoint is working",hasWebhookSecret:!!process.env.STRIPE_WEBHOOK_SECRET,timestamp:new Date().toISOString()})}let d=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/stripe/webhook/route",pathname:"/api/stripe/webhook",filename:"route",bundlePath:"app/api/stripe/webhook/route"},resolvedPagePath:"C:\\Users\\German\\Desktop\\Dashboard Viewers- LaCasa\\youtube-viewers-lacasa\\src\\app\\api\\stripe\\webhook\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:h,staticGenerationAsyncStorage:m,serverHooks:g}=d,b="/api/stripe/webhook/route";function v(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),r=t.X(0,[948,972,749,59],()=>o(81773));module.exports=r})();