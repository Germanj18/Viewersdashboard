"use strict";(()=>{var e={};e.id=130,e.ids=[130],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},92599:(e,a,r)=>{r.r(a),r.d(a,{originalPathname:()=>x,patchFetch:()=>f,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>c});var t={};r.r(t),r.d(t,{POST:()=>u});var o=r(49303),s=r(88716),n=r(60670),l=r(87070),i=r(88688);async function u(e){try{let a=await e.json();if(console.log("Datos recibidos:",a),!a||!Array.isArray(a.items))return console.error("Estructura de datos inv\xe1lida:",a),l.NextResponse.json({message:"Invalid data structure"},{status:400});let{items:r,confirmDelete:t}=a,o=r.filter(e=>e.date&&e.hour&&"number"==typeof e.luzu&&"number"==typeof e.olga&&"number"==typeof e.gelatina&&"number"==typeof e.blender&&"number"==typeof e.lacasa&&"number"==typeof e.vorterix&&"number"==typeof e.bondi&&"number"==typeof e.carajo&&"number"==typeof e.azz);console.log("Datos v\xe1lidos:",o);let s=o.map(e=>new Date(e.date.split(" ")[0])),n=await i._.excelData.findMany({where:{date:{in:s}}});if(n.length>0&&!t){let e=n[0].date.toISOString().split("T")[0];return l.NextResponse.json({message:`Se van a borrar los registros viejos de la fecha: ${e}. Si est\xe1s seguro, confirma la operaci\xf3n.`,confirmDelete:!0})}t&&await i._.excelData.deleteMany({where:{date:{in:s}}});for(let e=0;e<o.length;e+=50){let a=o.slice(e,e+50).map(e=>{let[a]=e.date.split(" "),r=new Date(a);return i._.excelData.create({data:{date:r,hour:e.hour,luzu:e.luzu,olga:e.olga,gelatina:e.gelatina,blender:e.blender,lacasa:e.lacasa,vorterix:e.vorterix,bondi:e.bondi,carajo:e.carajo,azz:e.azz}})});await Promise.all(a)}return console.log("Resultado de la inserci\xf3n: Datos subidos exitosamente"),l.NextResponse.json({message:"Data uploaded successfully"})}catch(e){return console.error("Error al procesar la solicitud:",e),l.NextResponse.json({message:"Internal server error"},{status:500})}finally{await i._.$disconnect()}}let p=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/uploadExcel/route",pathname:"/api/uploadExcel",filename:"route",bundlePath:"app/api/uploadExcel/route"},resolvedPagePath:"C:\\Users\\German\\Desktop\\Dashboard Viewers- LaCasa\\youtube-viewers-lacasa\\src\\app\\api\\uploadExcel\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:d,staticGenerationAsyncStorage:c,serverHooks:m}=p,x="/api/uploadExcel/route";function f(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:c})}},88688:(e,a,r)=>{r.d(a,{_:()=>t});let t=new(r(53524)).PrismaClient({log:["query","info","warn","error"]})}};var a=require("../../../webpack-runtime.js");a.C(e);var r=e=>a(a.s=e),t=a.X(0,[948,972],()=>r(92599));module.exports=t})();